{"version":3,"sources":["book-store.js"],"names":[],"mappings":"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","file":"book-store-compiled.js","sourcesContent":["class Book {\r\n    constructor(title, author, category, imgUrl, price, pages, description) {\r\n        this.title = title;\r\n        this.author = author;\r\n        this.category = category;\r\n        this.imgUrl = imgUrl;\r\n        this.price = price;\r\n        this.pages = pages;\r\n        this.description = description;\r\n    }\r\n\r\n    get title() {\r\n        return this._title;\r\n    }\r\n\r\n    set title(value) {\r\n        this._title = value;\r\n    }\r\n\r\n    get author() {\r\n        return this._author;\r\n    }\r\n\r\n    set author(value) {\r\n        this._author = value;\r\n    }\r\n\r\n    get category() {\r\n        return this._category;\r\n    }\r\n\r\n    set category(value) {\r\n        this._category = value;\r\n    }\r\n\r\n    get imgUrl() {\r\n        return this._imgUrl;\r\n    }\r\n\r\n    set imgUrl(value) {\r\n        this._imgUrl = value;\r\n    }\r\n\r\n    get price() {\r\n        return this._price;\r\n    }\r\n\r\n    set price(value) {\r\n        this._price = value;\r\n    }\r\n\r\n    get pages() {\r\n        return this._pages;\r\n    }\r\n\r\n    set pages(value) {\r\n        this._pages = value;\r\n    }\r\n\r\n    get description() {\r\n        return this._description;\r\n    }\r\n\r\n    set description(value) {\r\n        this._description = value;\r\n    }\r\n}\r\n\r\nclass User {\r\n    constructor(username, password, firstName, lastName, email, address, phoneNumber) {\r\n        this.username = username;\r\n        this.password = password;\r\n        this.firstName = firstName;\r\n        this.lastName = lastName;\r\n        this.email = email;\r\n        this.address = address;\r\n        this.phoneNumber = phoneNumber;\r\n    }\r\n\r\n    get username() {\r\n        return this._username;\r\n    }\r\n\r\n    set username(value) {\r\n        value = _formatInputData(value);\r\n        if (/[^A-Za-z0-9-_.]/g.test(value)) {\r\n            throw new Error('Username can only contain only latin letters, numbers, dash, underscore or a dot!');\r\n        }\r\n\r\n        this._username = value;\r\n    }\r\n\r\n    get password() {\r\n        return this._password;\r\n    }\r\n\r\n    set password(value) {\r\n        value = _formatInputData(value);\r\n        this._password = value;\r\n    }\r\n\r\n    get firstName() {\r\n        return this._firstName;\r\n    }\r\n\r\n    set firstName(value) {\r\n        value = _formatInputData(value);\r\n        _validateName(value);\r\n        this._firstName = value;\r\n    }\r\n\r\n    get lastName() {\r\n        return this._lastName;\r\n    }\r\n\r\n    set lastName(value) {\r\n        value = _formatInputData(value);\r\n        _validateName(value);\r\n        this._lastName = value;\r\n    }\r\n\r\n    get email() {\r\n        return this._email;\r\n    }\r\n\r\n    set email(value) {\r\n        value = _formatInputData(value);\r\n        let pattern = /^\\w+@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$/;\r\n        if (value.match(pattern).length < 1) {\r\n            throw new Error('Invalid email address!');\r\n        }\r\n\r\n        this._email = value;\r\n    }\r\n\r\n    get address() {\r\n        return this._address;\r\n    }\r\n\r\n    set address(value) {\r\n        value = _formatInputData(value);\r\n        this._address = value;\r\n    }\r\n\r\n    get phoneNumber() {\r\n        return this._phoneNumber;\r\n    }\r\n\r\n    set phoneNumber(value) {\r\n        value = _formatInputData(value);\r\n\r\n        if (/[^0-9]/g.test(value)) {\r\n            throw new Error('Invalid telephone number!');\r\n        }\r\n\r\n        this._phoneNumber = value;\r\n    }\r\n\r\n    _formatInputData(value) {\r\n        value = value.trim();\r\n        var illegalSymbolsMap = {\r\n            \"&\": \"&amp;\",\r\n            \"<\": \"&lt;\",\r\n            \">\": \"&gt;\",\r\n            '\"': '&quot;',\r\n            \"'\": '&#39;',\r\n            \"/\": '&#x2F;'\r\n        };\r\n\r\n        function escapeHtml(str) {\r\n            return String(str).replace(/[&<>\"'\\/]/g, function (s) {\r\n                return entityMap[s];\r\n            });\r\n        }\r\n\r\n        value = escapeHtml(value);\r\n        return value;\r\n    }\r\n\r\n    _validateName(name) {\r\n        if (/^[^A-Z]/.test(name)) {\r\n            throw new Error('Name must begin with a capital letter!');\r\n        }\r\n\r\n        for (let i = 1; i < name.length; i += 1) {\r\n            if (/^a-z-/g.test(name[i])) {\r\n                throw new Error('Disallowed characters! A name must begin with a capital letter and continue with lower case latin symbols!');\r\n            }\r\n\r\n            if (name[i - 1] === '-' && name[i] === '-') {\r\n                throw new Error('There cannot be two or more successive dashes in a name!');\r\n            }\r\n        }\r\n    }\r\n}\r\nclass Author {\r\n    constructor(name, description) {\r\n        this.name = name;\r\n        this.description = description;\r\n        this._books = [];\r\n    }\r\n\r\n    get name() {\r\n        return this._name;\r\n    }\r\n\r\n    set name(name) {\r\n        if (typeof name !== \"string\") {\r\n            throw new Error(\"Name must be a string.\");\r\n        }\r\n        this._name = name;\r\n    }\r\n\r\n    get description() {\r\n        return this._description;\r\n    }\r\n\r\n    set description(description) {\r\n        if (typeof description !== \"string\") {\r\n            throw new Error(\"Description must be a string.\");\r\n        }\r\n        if (description.length <= 10 && description.length > 50) {\r\n            throw new Error(\"Description must be between 10 and 50 symbols long.\");\r\n        }\r\n        this._description = description;\r\n    }\r\n\r\n    get books() {\r\n        return this._books;\r\n    }\r\n\r\n    set books(value) {\r\n        throw new Error(\"Books cannot be changed.Use add remove or removeAll methods instead.\");\r\n    }\r\n\r\n    add(book) {\r\n        if (!(book instanceof Book)) {\r\n            throw new Error(\"Only books can be added.\");\r\n        }\r\n        else this.books.push(book);\r\n    }\r\n\r\n    remove(book) {\r\n        var index = this.books.indexOf(book);\r\n        if (index < 0) {\r\n            throw new Error(\"Book not found.\");\r\n        }\r\n        this.books.splice(index, 1);\r\n    }\r\n\r\n    removeAll() {\r\n        this._books = [];\r\n    }\r\n}\r\n\r\nif (typeof window === 'undefined') {\r\n    module.exports = {Book, User, Author}\r\n}\r\n\r\n/* globals requester localStorage */\r\n\"use strict\";\r\nvar dataService = {\r\n    getInstance(requester) {\r\n        const HTTP_HEADER_KEY = \"x-auth-key\",\r\n            KEY_STORAGE_USERNAME = \"username\",\r\n            KEY_STORAGE_AUTH_KEY = \"authKey\",\r\n            CURRENT_USER_ID = \"userID\",\r\n            APP_ID = \"kid_SkGEDPt6\",\r\n            APP_SECRET = \"1ddc36c888904211906588c736731c4d\",\r\n            APP_KEY = \"2c9b407d779742d18a5e4afef9700855\";\r\n\r\n        var cachedBooks = {};\r\n\r\n        function _cacheBook(book) {\r\n            cachedBooks[book._id] = new Book(book.title, book.author, book.category, book.imgUrl, book.price, book.pages, book.description)\r\n        }\r\n\r\n        function _unCacheBook(book) {\r\n            cachedBooks[book._id] = undefined;\r\n        }\r\n\r\n        function login(user) {\r\n            let encodedAppKey = btoa(`${APP_ID}:${APP_SECRET}`),\r\n                headers = {\r\n                    'Authorization': `Basic ${encodedAppKey}`\r\n                };\r\n\r\n            return requester.postJSON(`https://baas.kinvey.com/user/${APP_ID}/login`, user, headers)\r\n                .then(response => {\r\n                    localStorage.setItem(KEY_STORAGE_USERNAME, response.username);\r\n                    localStorage.setItem(KEY_STORAGE_AUTH_KEY, response._kmd.authtoken);\r\n                    localStorage.setItem(CURRENT_USER_ID, response._id);\r\n                });\r\n        }\r\n\r\n        function register(user) {\r\n            let encodedAppKey = btoa(`${APP_ID}:${APP_SECRET}`),\r\n                headers = {\r\n                    'Authorization': `Basic ${encodedAppKey}`\r\n                };\r\n\r\n            return requester.postJSON(`https://baas.kinvey.com/user/${APP_ID}/`, user, headers);\r\n        }\r\n\r\n        function logout() {\r\n            let body = {},\r\n                headers = {\r\n                    'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n                };\r\n\r\n            return requester.postJSON(`https://baas.kinvey.com/user/${APP_ID}/_logout`, body, headers)\r\n                .then((response) => {\r\n                    console.log(response);\r\n                    localStorage.removeItem(KEY_STORAGE_USERNAME);\r\n                    localStorage.removeItem(KEY_STORAGE_AUTH_KEY);\r\n                    localStorage.removeItem(CURRENT_USER_ID);\r\n                });\r\n        }\r\n\r\n        function isLoggedIn() {\r\n            return Promise.resolve()\r\n                .then(() => {\r\n                    return !!localStorage.getItem(KEY_STORAGE_USERNAME);\r\n                });\r\n        }\r\n\r\n        function getCart() {\r\n            let headers = {\r\n                'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n            };\r\n\r\n            return requester.getJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, headers)\r\n                .then((response) => {\r\n                    return response.books;\r\n                })\r\n        }\r\n\r\n        function addToCart(book) {\r\n            return getCart()\r\n                .then(((cart) => {\r\n                    cart.push(book);\r\n                    let headers = {\r\n                        'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n                    };\r\n\r\n                    return requester.getJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, headers)\r\n                        .then(response => {\r\n                            var body = {\r\n                                books: cart,\r\n                                username: response.username,\r\n                                address: response.address,\r\n                                phone: response.phone,\r\n                                email: response.email\r\n                            };\r\n                            return requester.putJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, body, headers);\r\n                        });\r\n                }));\r\n        }\r\n\r\n        function removeFromCart(book) {\r\n            return getCart()\r\n                .then(((cart) => {\r\n                    for (let i = 0; i < cart.length; i += 1) {\r\n                        if (book._id == cart[i]._id) {\r\n                            cart.splice(i, 1);\r\n                            break;\r\n                        }\r\n                    }\r\n                    let headers = {\r\n                        'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n                    };\r\n\r\n                    return requester.getJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, headers)\r\n                        .then(response => {\r\n                            var body = {\r\n                                books: cart,\r\n                                username: response.username,\r\n                                address: response.address,\r\n                                phone: response.phone,\r\n                                email: response.email\r\n                            };\r\n                            return requester.putJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, body, headers);\r\n                        });\r\n                }));\r\n        }\r\n\r\n        function clearCart() {\r\n            let headers = {\r\n                'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n            };\r\n\r\n            return requester.getJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, headers)\r\n                .then(response => {\r\n                    var body = {\r\n                        books: [],\r\n                        username: response.username,\r\n                        address: response.address,\r\n                        phone: response.phone,\r\n                        email: response.email\r\n                    };\r\n\r\n                    return requester.putJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, body, headers);\r\n                });\r\n        }\r\n\r\n        function getAllBooks() {\r\n            let encodedAppKey = btoa(`${APP_ID}:${APP_KEY}`),\r\n                headers = {\r\n                    'Authorization': `Basic ${encodedAppKey}`\r\n                };\r\n\r\n            return requester.getJSON(`https://baas.kinvey.com/appdata/${APP_ID}/booksDataBase`, headers)\r\n                .then(response => {\r\n                    response.forEach(book => {\r\n                        cachedBooks[book._id] = new Book(book.title, book.author, book.category, book.imgUrl, book.price, book.pages, book.description);\r\n                    });\r\n                    return cachedBooks;\r\n                });\r\n        }\r\n\r\n        function getBookById(id) {\r\n            if (cachedBooks[id]) {\r\n                return Promise.resolve(cachedBooks[id]);\r\n            }\r\n            else {\r\n                let headers = {\r\n                    'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n                };\r\n\r\n                return requester.getJSON(`https://baas.kinvey.com/appdata/${APP_ID}/booksDataBase/${id}`, headers)\r\n                    .then(book => {\r\n                        _cacheBook(book);\r\n                        return book;\r\n                    });\r\n            }\r\n        }\r\n\r\n        function placeOrder(totalPrice) {\r\n            return getCart().then(cart => {\r\n                let body = {\r\n                        userId: localStorage.getItem(CURRENT_USER_ID),\r\n                        books: cart,\r\n                        status: \"open\",\r\n                        totalPrice: totalPrice\r\n                    },\r\n                    headers = {\r\n                        'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n                    };\r\n\r\n                return requester.postJSON(`https://baas.kinvey.com/appdata/${APP_ID}/orders`, body, headers);\r\n            });\r\n        }\r\n\r\n        function getOrdersByUserId() {\r\n            let headers = {\r\n                'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n            };\r\n\r\n            return requester.getJSON(`https://baas.kinvey.com/appdata/${APP_ID}/orders/?query={\"userId\":\"${localStorage.getItem(CURRENT_USER_ID)}\"}`, headers);\r\n        }\r\n\r\n        function getCurrentUserData() {\r\n            let headers = {\r\n                'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n            };\r\n\r\n            return requester.getJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, headers);\r\n        }\r\n\r\n        function updateUserData(body) {\r\n            let headers = {\r\n                'Authorization': `Kinvey ${localStorage.getItem(KEY_STORAGE_AUTH_KEY)}`\r\n            };\r\n            return requester.putJSON(`https://baas.kinvey.com/user/${APP_ID}/${localStorage.getItem(CURRENT_USER_ID)}`, body, headers);\r\n        }\r\n\r\n        return {\r\n            login,\r\n            register,\r\n            logout,\r\n            isLoggedIn,\r\n            getCart,\r\n            addToCart,\r\n            removeFromCart,\r\n            getAllBooks,\r\n            getBookById,\r\n            placeOrder,\r\n            clearCart,\r\n            getCurrentUserData,\r\n            getOrdersByUserId,\r\n            updateUserData\r\n        }\r\n    }\r\n};\r\n\r\n/* globals dataService templates $ Handlebars console */\r\n\"use strict\";\r\nlet pageController = {\r\n    getInstance(dataService, templates, $) {\r\n        var $mainContainer = $('#container');\r\n\r\n        if ($mainContainer.length < 1) {\r\n            throw new Error(\"No #container found on page!\")\r\n        }\r\n\r\n        function _changePageHtml(html) {\r\n            $mainContainer.html(html);\r\n        }\r\n\r\n        function _toggleButtonsIfLoggedIn() {\r\n            dataService.isLoggedIn().then(isLoggedIn => {\r\n                if (isLoggedIn) {\r\n                    $(\"#logged-in\").removeClass('hidden');\r\n                    $(\"#logged-out\").addClass('hidden');\r\n                }\r\n                else {\r\n                    $(\"#logged-in\").addClass('hidden');\r\n                    $(\"#logged-out\").removeClass('hidden');\r\n                }\r\n            });\r\n        }\r\n\r\n        _toggleButtonsIfLoggedIn();\r\n\r\n        function home() {\r\n            _toggleButtonsIfLoggedIn();\r\n\r\n            templates.compile('products').then(html => {\r\n                _changePageHtml(html);\r\n            });\r\n\r\n            dataService.getAllBooks()\r\n                .then((booksCollection) => {\r\n                    let booksObject = {\r\n                        books: booksCollection\r\n                    };\r\n\r\n                    return templates.compile('products', booksObject);\r\n                })\r\n                .then((html) => {\r\n                    _changePageHtml(html);\r\n                });\r\n        }\r\n\r\n        function login() {\r\n            templates.compile('login')\r\n                .then(function (html) {\r\n                    _changePageHtml(html);\r\n\r\n                    $('#btn-login').on('click', function () {\r\n                        var user = {\r\n                            username: $('#tb-username').val(),\r\n                            password: $('#tb-password').val()\r\n                        };\r\n                        dataService.login(user)\r\n                            .then(function () {\r\n                                toastr.success('User Logged in!');\r\n                                $(location).attr('href', '#/products');\r\n                            })\r\n                            .catch(err => {\r\n                                toastr.error(err.responseJSON.description);\r\n                                $(location).attr('href', '#/register')\r\n                            });\r\n                    });\r\n                });\r\n        }\r\n\r\n        function getAuthors() {\r\n            //TODO: use requester object & move to data.js\r\n\r\n            return new Promise((resolve, reject) => {\r\n                $.ajax({\r\n                    url: url,\r\n                    type: \"GET\",\r\n                    contentType: \"application/json\"\r\n                }).done(resolve).fail(reject)\r\n            });\r\n        }\r\n\r\n        function search(params) {\r\n            dataService.getAllBooks()\r\n                .then((booksObj) => {\r\n                    let tempBooks = [],\r\n                        searchPattern = decodeURI(params.productName).toLowerCase();\r\n\r\n                    for (let bookID in booksObj) {\r\n                        tempBooks.push(booksObj[bookID])\r\n                        tempBooks[tempBooks.length - 1]._id = bookID;\r\n                    }\r\n\r\n                    let filteredBooks = [];\r\n                    for (let book of tempBooks) {\r\n                        if (book.title.toLowerCase().indexOf(searchPattern) > 0 ||\r\n                            book.author.toLowerCase().indexOf(searchPattern) > 0 ||\r\n                            book.category.toLowerCase().indexOf(searchPattern) > 0 ||\r\n                            book.description.toLowerCase().indexOf(searchPattern) > 0) {\r\n                            filteredBooks.push(book);\r\n                        }\r\n                    }\r\n\r\n                    console.log(tempBooks);\r\n                    console.log(filteredBooks);\r\n\r\n                    let body = {\r\n                        searchValue: decodeURI(params.productName)\r\n                    };\r\n                    if (filteredBooks.length > 0) {\r\n                        body.books = filteredBooks;\r\n                    }\r\n\r\n                    return templates.compile('search', body);\r\n                })\r\n                .then((html) => {\r\n                    _changePageHtml(html);\r\n                });\r\n        }\r\n\r\n        function categories(params) {\r\n            dataService.getAllBooks()\r\n                .then((booksObj) => {\r\n                    let filteredBooks = [];\r\n                    let label = decodeURI(params.category);\r\n                    if (params.category == 'all-categories') {\r\n                        for (let bookID in booksObj) {\r\n                            filteredBooks.push(booksObj[bookID])\r\n                            filteredBooks[filteredBooks.length - 1]._id = bookID;\r\n                        }\r\n                    }\r\n                    else {\r\n                        for (let bookID in booksObj) {\r\n                            if (booksObj[bookID].category.toLowerCase() == label.toLowerCase()) {\r\n                                filteredBooks.push(booksObj[bookID])\r\n                                filteredBooks[filteredBooks.length - 1]._id = bookID;\r\n                            }\r\n                        }\r\n                    }\r\n\r\n                    let books = {};\r\n                    if (filteredBooks.length > 0) {\r\n                        books = {\r\n                            books: filteredBooks\r\n                        }\r\n                    }\r\n\r\n                    if (params.category == 'all-categories') {\r\n                        books.sectionCategory = 'All Categories';\r\n                    }\r\n                    else {\r\n                        books.sectionCategory = label.substr(0, 1).toUpperCase() + label.substr(1);\r\n                    }\r\n\r\n                    return templates.compile('category', books);\r\n                })\r\n                .then((html) => {\r\n                    _changePageHtml(html);\r\n                });\r\n        }\r\n\r\n        function productById(params) {\r\n            let targetBook;\r\n            dataService.getBookById(params.id)\r\n                .then((book) => {\r\n                    targetBook = book;\r\n                    book.pageUrl = encodeURIComponent(window.location.href);\r\n                    return templates.compile('book-instance', book);\r\n                })\r\n                .then((html) => {\r\n                    _changePageHtml(html);\r\n                    $('#btn-add-to-cart').on('click', () => {\r\n                        if (dataService.isLoggedIn()) {\r\n                            dataService.addToCart(targetBook)\r\n                                .then((res, err) => {\r\n                                    if (!err) {\r\n                                        toastr.success('Book added to cart!')\r\n                                    }\r\n                                })\r\n                                .catch(err => {\r\n                                    toastr.error(err.responseJSON.description + \". Please log in!\")\r\n                                });\r\n                        }\r\n                        else {\r\n                            throw new Error('You must be logged in to add a book to the cart!')\r\n                        }\r\n                    })\r\n                })\r\n                .catch(err => {\r\n                    toastr.error(err);\r\n                })\r\n        }\r\n\r\n        function about() {\r\n            templates.compile('about').then(html => {\r\n                _changePageHtml(html);\r\n            });\r\n        }\r\n\r\n        function contacts() {\r\n            templates.compile('contacts').then(html => {\r\n                _changePageHtml(html);\r\n            });\r\n        }\r\n\r\n        return {\r\n            home,\r\n            search,\r\n            categories,\r\n            productById,\r\n            about,\r\n            contacts\r\n        };\r\n    }\r\n};\r\n\r\nif (typeof window === 'undefined') {\r\n    module.exports = pageController.getInstance;\r\n}\r\n\r\n/* globals $ Promise */\r\n\"use strict\";\r\nlet requester = {\r\n    getInstance(asyncEngine){\r\n        return {\r\n            get(url) {\r\n                return new Promise((resolve, reject) => {\r\n                    asyncEngine.ajax({\r\n                        url: url,\r\n                        method: \"GET\",\r\n                        success(response) {\r\n                            resolve(response);\r\n                        },\r\n                        error(err) {\r\n                            reject(err);\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            putJSON(url, body, headers = {}) {\r\n                return new Promise((resolve, reject) => {\r\n                    asyncEngine.ajax({\r\n                        url: url,\r\n                        headers: headers,\r\n                        method: \"PUT\",\r\n                        contentType: \"application/json\",\r\n                        data: JSON.stringify(body),\r\n                        success(response) {\r\n                            resolve(response);\r\n                        },\r\n                        error(err) {\r\n                            reject(err);\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            postJSON(url, body, headers = {}) {\r\n                return new Promise((resolve, reject) => {\r\n                    asyncEngine.ajax({\r\n                        url: url,\r\n                        headers: headers,\r\n                        method: \"POST\",\r\n                        contentType: \"application/json\",\r\n                        data: JSON.stringify(body),\r\n                        success(response) {\r\n                            resolve(response);\r\n                        },\r\n                        error(err) {\r\n                            reject(err);\r\n                        }\r\n                    });\r\n                });\r\n            },\r\n            getJSON(url, headers = {}) {\r\n                return new Promise((resolve, reject) => {\r\n                    asyncEngine.ajax({\r\n                        url: url,\r\n                        method: \"GET\",\r\n                        headers: headers,\r\n                        contentType: \"application/json\",\r\n                        success(response) {\r\n                            resolve(response);\r\n                        },\r\n                        error(err) {\r\n                            reject(err);\r\n                        }\r\n                    });\r\n                });\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nif (typeof window === 'undefined') {\r\n    module.exports = requester.getInstance;\r\n}\r\n// export { requester }\r\n\r\nlet templates = {\r\n    getInstance(requester, templateEngine) {\r\n        \"use strict\";\r\n        var cachedTemplates = {};\r\n\r\n        function _get(name) {\r\n            if (cachedTemplates[name]) {\r\n                return Promise.resolve(cachedTemplates[name]);\r\n            }\r\n            else {\r\n                let url = `./templates/${name}.handlebars`;\r\n\r\n                return requester.get(url)\r\n                    .then(template => {\r\n                        cachedTemplates[name] = template;\r\n                        return Promise.resolve(template);\r\n                    });\r\n            }\r\n        }\r\n\r\n        function compile(templateName, data) {\r\n            var result = _get(templateName).then(template => {\r\n                var templateFunction = templateEngine.compile(template);\r\n                return templateFunction(data);\r\n            });\r\n\r\n            return result;\r\n        }\r\n\r\n        return {\r\n            compile\r\n        }\r\n    }\r\n};\r\n\r\nif (typeof window === 'undefined') {\r\n    module.exports = templates;\r\n}\r\n\r\n/* globals dataService templates $ Handlebars console */\r\n\"use strict\";\r\nlet userController = {\r\n    getInstance(dataService, templates, $) {\r\n        var $mainContainer = $('#container');\r\n\r\n        if ($mainContainer.length < 1) {\r\n            throw new Error(\"No #container found on page!\")\r\n        }\r\n\r\n        function _changePageHtml(html) {\r\n            $mainContainer.html(html);\r\n        }\r\n\r\n        function _toggleButtonsIfLoggedIn() {\r\n            dataService.isLoggedIn().then(isLoggedIn => {\r\n                if (isLoggedIn) {\r\n                    $(\"#logged-in\").removeClass('hidden');\r\n                    $(\"#logged-out\").addClass('hidden');\r\n                }\r\n                else {\r\n                    $(\"#logged-in\").addClass('hidden');\r\n                    $(\"#logged-out\").removeClass('hidden');\r\n                }\r\n            });\r\n        }\r\n\r\n        _toggleButtonsIfLoggedIn();\r\n\r\n        function cart() {\r\n            var totalPrice = 0;\r\n            dataService.getCart()\r\n                .then(booksInCart => {\r\n                    booksInCart.forEach(book => {\r\n                        totalPrice += book._price;\r\n                    });\r\n\r\n                    var data = {};\r\n                    if (booksInCart.length > 0) {\r\n                        totalPrice = Math.round(totalPrice * 100) / 100;\r\n                        data = {\r\n                            books: booksInCart,\r\n                            totalPrice: totalPrice\r\n                        }\r\n                    }\r\n                    return templates.compile('cart', data);\r\n                })\r\n                .then((html) => {\r\n                    _changePageHtml(html);\r\n\r\n                    $('.remove-from-cart').click((ev) => {\r\n                        var bookId = $(ev.target).attr('data-book-id');\r\n                        dataService.getBookById(bookId).then(book => {\r\n                            return dataService.removeFromCart(book);\r\n                        }).then(() => {\r\n                            cart();\r\n                        })\r\n                    });\r\n\r\n                    $('#checkout-btn').click((ev) => {\r\n                        dataService.placeOrder(totalPrice)\r\n                            .then(() => {\r\n                                toastr.success(\"Order has been successfully placed!\");\r\n                                return dataService.clearCart();\r\n                            })\r\n                            .then(() => {\r\n                                $(location).attr('href', '#/products');\r\n                            })\r\n                            .catch(err => {\r\n                                toastr.error(err.responseJSON.description);\r\n                            });\r\n                    });\r\n                });\r\n        }\r\n\r\n        function login() {\r\n            templates.compile('login')\r\n                .then(function (html) {\r\n                    _changePageHtml(html);\r\n\r\n                    $('#btn-login').on('click', function () {\r\n                        var user = {\r\n                            username: $('#tb-username').val().trim(),\r\n                            password: $('#tb-password').val().trim()\r\n                        };\r\n                        dataService.login(user)\r\n                            .then(function () {\r\n                                toastr.success('User Logged in!');\r\n                                $(location).attr('href', '#/products');\r\n                            })\r\n                            .catch(err => {\r\n                                toastr.error(err.responseJSON.description);\r\n                                $('#tb-username').val('');\r\n                                $('#tb-password').val('');\r\n                            });\r\n                    });\r\n                });\r\n        }\r\n\r\n        function register() {\r\n            templates.compile('register')\r\n                .then(function (html) {\r\n                    _changePageHtml(html);\r\n\r\n                    $('#btn-register').on('click', function (ev) {\r\n                        ev.preventDefault();\r\n                        ev.stopPropagation();\r\n                        if (!$('#register-form')[0].checkValidity || $('#register-form')[0].checkValidity()) {\r\n                            var user = {\r\n                                username: $('#tb-username').val(),\r\n                                password: $('#tb-password').val(),\r\n                                email: $('#tb-email').val(),\r\n                                phone: $('#tb-phone').val(),\r\n                                address: $('#tb-address').val(),\r\n                                books: []\r\n                            };\r\n\r\n                            dataService.register(user)\r\n                                .then(function () {\r\n                                    toastr.success('User registered!');\r\n                                    $(location).attr('href', '#/login');\r\n                                })\r\n                                .catch(err => {\r\n                                    toastr.error(err.responseJSON.description);\r\n                                });\r\n                        }\r\n                        else {\r\n                            toastr.error(\"Please fill out all fields correctly!\")\r\n                        }\r\n                    });\r\n                });\r\n        }\r\n\r\n        function logout() {\r\n            dataService.logout()\r\n                .then(function () {\r\n                    toastr.success('User Logged out!')\r\n                    $(location).attr('href', '#/products')\r\n                });\r\n        }\r\n\r\n        function profile() {\r\n            let userData,\r\n                orderData;\r\n\r\n            Promise.all([dataService.getCurrentUserData(), dataService.getOrdersByUserId()])\r\n                .then(values => {\r\n                    userData = values[0],\r\n                        orderData = values[1];\r\n                    return {user: userData, orders: orderData}\r\n                })\r\n                .then(data => {\r\n                    return templates.compile('profile', data);\r\n                })\r\n                .then(html => {\r\n                    _changePageHtml(html);\r\n\r\n                    $('#submit-user-data').click(ev => {\r\n                        var $form = $('#profile-form')[0];\r\n                        if (!$form.checkValidity || $form.checkValidity()) {\r\n                            userData.address = $('#user-address-input').val();\r\n                            userData.phone = $('#user-phone-input').val();\r\n\r\n                            dataService.updateUserData(userData).then(() => {\r\n                                $(location).attr('href', '#/products');\r\n                                toastr.success('Your profile information has been updated!');\r\n                            }).catch(err => {\r\n                                toastr.error(err.responseJSON.description);\r\n                            })\r\n                        }\r\n                    });\r\n                })\r\n                .catch(err => {\r\n                    toastr.error(err.responseJSON.description);\r\n                });\r\n        }\r\n\r\n        return {\r\n            login,\r\n            register,\r\n            logout,\r\n            profile,\r\n            cart\r\n        };\r\n    }\r\n};\r\n/* globals Navigo controllers $ dataService document templates requester*/\r\n\"use strict\";\r\n// import {templates} from 'templates';\r\n// import {dataService} from 'dataService';\r\n// import {controllers} from 'controllers';\r\n// import {requester} from 'requester';\r\n\r\nlet requesterInstance = requester.getInstance($);\r\nlet templateInstance = templates.getInstance(requesterInstance, Handlebars);\r\nlet dataServiceInstance = dataService.getInstance(requesterInstance);\r\nlet router = new Navigo(null, true);\r\n\r\nlet userControllerInstance = userController.getInstance(dataServiceInstance, templateInstance, $);\r\nlet pageControllerInstance = pageController.getInstance(dataServiceInstance, templateInstance, $);\r\n\r\nrouter\r\n    .on('/products', pageControllerInstance.home)\r\n    .on(\"/login\", userControllerInstance.login)\r\n    .on('/register', userControllerInstance.register)\r\n    .on(\"/logout\", userControllerInstance.logout)\r\n    .on(\"/profile\", userControllerInstance.profile)\r\n    .on(\"/cart\", userControllerInstance.cart)\r\n    .on(\"/search/:productName\", pageControllerInstance.search)\r\n    .on(\"/products/:category\", pageControllerInstance.categories)\r\n    .on(\"/products/review/:id\", pageControllerInstance.productById)\r\n    // .on(\"/authors\", pageControllerInstance.authors)\r\n    .on(\"/about\", pageControllerInstance.about)\r\n    .on(\"/contacts\", pageControllerInstance.contacts)\r\n    .on(\"/home\", () => {\r\n        router.navigate(\"/products\");\r\n    })\r\n    .on(\"/\", () => {\r\n        router.navigate(\"/products\");\r\n    })\r\n    .on(\"\", () => {\r\n        router.navigate(\"/products\");\r\n    })\r\n    .resolve();\r\n\r\n$('#btn-search').on('click', () => {\r\n    let searchBar = $('#search-bar'),\r\n        searchValue = encodeURI(searchBar.val().trim());\r\n    if (!searchValue) {\r\n        return;\r\n    }\r\n    router.navigate(`/search/${searchValue}`)\r\n    searchBar.val('');\r\n});\r\n\r\ntoastr.options = {\r\n    \"closeButton\": true,\r\n    \"debug\": false,\r\n    \"newestOnTop\": true,\r\n    \"progressBar\": false,\r\n    \"positionClass\": \"toast-top-center\",\r\n    \"preventDuplicates\": true,\r\n    \"onclick\": null,\r\n    \"showDuration\": \"300\",\r\n    \"hideDuration\": \"300\",\r\n    \"timeOut\": \"2000\",\r\n    \"extendedTimeOut\": \"1000\",\r\n    \"showEasing\": \"swing\",\r\n    \"hideEasing\": \"linear\",\r\n    \"showMethod\": \"fadeIn\",\r\n    \"hideMethod\": \"fadeOut\"\r\n};\r\n \r\n//export {controllers}"]}